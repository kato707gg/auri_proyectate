import 'dart:convert';
import 'dart:io';
import 'package:flutter/cupertino.dart';
import 'package:flutter/material.dart';
import 'package:http/http.dart' as http;

class EditPhotoScreen extends StatelessWidget {
  final String imagePath;

  const EditPhotoScreen({Key? key, required this.imagePath}) : super(key: key);

  Future<void> makePredictionRequest() async {
    final String apiUrl = "https://api.replicate.com/v1/predictions";
    final String authToken = "Token r8_cbAmgoyJPEbI8rQ4EcUorwso9yArZwY41ixtM";

    // Construct the image URI directly using Uri.parse
    String imageUri = Uri.parse(imagePath).toString();

    // Construct the JSON payload
    Map<String, dynamic> payload = {
      "version": "ae80bbe1adce7d616b8a96ba88a91d3556838d4f2f4da76327638b8e95ea4694",
      "input": {
        "img": "data:image/jpeg;base64,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",
        "scale": 2,
        "version": "v1.3"
      }
    };

    // Convert payload to JSON
    String jsonString = jsonEncode(payload);

    // Make the HTTP POST request
    final response = await http.post(
      headers: {
        "Content-Type": "application/json",
        "Authorization": authToken,
      },
      body: jsonString,
      Uri.parse(apiUrl),
    );

    // Handle the response here (e.g., parse the JSON response)
    print(response.body);
    print(jsonString);
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Editar Foto'),
      ),
      body: Center(
        child: Image.file(File(imagePath)),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: makePredictionRequest,
        tooltip: 'Make Prediction',
        child: Icon(Icons.send),
      ),
    );
  }
}
